# 小项目 基于套接字的简单通信程序

客户机定时每`500ms`（代码中为`1s`）向服务器发送一个随机整数，范围在`1~500`之间；服务器每收到一份数据也同时产生随机整数与收到的数据相加，只有在结果大于100时才会把计算结果返回给客户机，而客户机收到超出`100`的结果则立即产生一个新的数据，而不是在间隔`500ms`（代码中为`1s`）后。客户机需要产生`20`份数据。

# 运行时间计算

记`N`为`20`份数据中超过`100`的结果的数量，且忽略数据在服务端相加后才大于`100`的数据，必有如下推论

1. 一次请求触发新请求的概率为`0.8+0.2*0.8+0.2*0.5*0.2*0.5=0.97`
2. 一个大于`100`的数将平均产生`1+0.97+0.97*0.97+...≈33`次请求

假设一次完整请求耗时`T`，则运行时间平均约为`(20-N)(1+T)+33NT=20-N+20T+32NT`

按概率推断`N=19.4`，则运行时间平均为`0.6+640.8T`

假设`T=1ms`，则总用时平均为`1240.8ms`

实际运行`10`次，结果如下
```
1016 2017 1022 1013 1014
1012 1013 1016 1013 2011
```
均值为`1214.7ms`，与预测基本吻合。